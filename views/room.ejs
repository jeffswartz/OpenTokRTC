<!DOCTYPE html>
<html lang="en">
<head>
  <title>WebRTC Demo - Video chatting in room <%= rid %></title>
  <% include _header %>
  <link rel="stylesheet" href="/css/room.css" />
  <script src="//static.opentok.com/webrtc/v2.2/js/opentok.js"></script>
  <script src="/vendors/handlebars.js" type="text/javascript"></script>
  <script src="/js/layoutContainer.js" type="text/javascript"></script>
</head>
<body>

<div class="container">

  <div id="streams_container">
    <div class="streamContainer" id="myPublisherContainer">
      <div id="myPublisher"></div>
    </div>
  </div>

  <div id="chatroom">
    <section id="title">
      <div id="title_content">
        <h1 class="titleText"><%= rid %></h1>
        <p>
        Invite: 
         <a href="mailto:?subject=Join me in a Video Conference&body=Please join me in a video conference at https://OpenTokRTC.com/<%= rid %>">
            https://opentokrtc.com/<%= rid %>
         </a> 
        </p>
      </div>
    </section>

    <div id="displayChat"></div>
    <div id="chatInput">
      <input type="" id="messageInput" disabled/>
      <i class="icon-comments-alt"></i>
    </div>
  </div>

  <div id="controlsContainer">
    <div class="controlsHeader">
      <div class="headerOption selected" data-option="controlOptions">Control</div><div class="headerOption" data-option="filterOptions">Filters</div>
    </div>
    <div class="controlsBody">
      <div id="controlOptions" class="optionContainer">
        <h1 class="controlOption option" id="recordButton" data-activity="record">Record</h1>
      </div>
      <div id="filterOptions" class="optionContainer">
        <h1 class="filterOption option" data-value="Blur">Blur</h1>
        <h1 class="filterOption option" data-value="Sepia">Sepia</h1>
        <h1 class="filterOption option" data-value="Grayscale" >Grayscale</h1>
        <h1 class="filterOption option" data-value="Invert" >Invert</h1>
        <h1 class="filterOption selected option" data-value="None">None</h1>
      </div>
    </div>
  </div>
</div>


<script id="messageTemplate" type="text/x-handlebars-template">
<div class="chatMessage"><em>{{name}}: </em>{{{text}}}</div>
</script>

<script id="notifyTemplate" type="text/x-handlebars-template">
  <div class="chatEvent chatMessage"><em>{{{message}}}</em></div>
</script>

<script id="userStreamTemplate" type="text/x-handlebars-template">
  <div class="streamContainer {{id}}" data-connectionid="{{connectionId}}">
    <div id="{{id}}"></div>
    <div class="flagUser" data-streamconnection="{{id}}">Remove User</div>
  </div>
</script>

<script src="/js/room.js" type="text/javascript"></script>
<script type="text/javascript">
  if (!OT.checkSystemRequirements()) {
    var queryString = encodeURIComponent("apk=<%= apiKey %>&sid=<%= sid %>"
      + "&tkn=<%= token %>rurl=XXX&logo=XXX&room=<%= rid %>&pname=XXX");
    var otExtensionUrl = "otvideo://start?" + queryString;
    console.log(otExtensionUrl);
    window.location =otExtensionUrl;
  } else {
    new User("<%= rid %>", "<%= apiKey %>", "<%= sid %>", "<%= token %>");
  }
</script>

<% include _analytics %>

</body>
</html>
